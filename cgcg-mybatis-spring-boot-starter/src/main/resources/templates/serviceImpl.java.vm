package ${package.ServiceImpl};

import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Service;

import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
import com.baomidou.mybatisplus.core.toolkit.Wrappers;
import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import com.cgcg.mybatis.plus.BaseServiceImpl;
import ${package.Entity}.${entity};
import ${package.Mapper}.${table.mapperName};
import ${package.Service}.${table.serviceName};

/**
 * $!{table.comment} 服务实现类
 *
 * @author ${author}
 * @date ${cfg.datetime}
 */
@Service
#if(${kotlin})
open class ${table.serviceImplName} : ${superServiceImplClass}<${table.mapperName}, ${entity}>(), ${table.serviceName} {

        }
#else
public class ${table.serviceImplName} extends BaseServiceImpl<${table.mapperName}, ${entity}> implements ${table.serviceName} {

    /**
     * 查询$!{table.comment}分页数据
     *
     * @param page 分页参数
     * @param keyword 关键字
     * @return Page<${entity}>
     * @author zhicong.lin
     * @date ${cfg.datetime}
     */
    @Override
    public Page<${entity}> findPage(Page<${entity}> page, String keyword) {
        QueryWrapper<${entity}> wrapper = Wrappers.query();
        wrapper.lambda().and(StringUtils.isNotBlank(keyword), w -> w
        #foreach($field in ${table.fields})
                #if(${field.propertyType.equals("boolean")})
                        #set($getprefix="is")
                #else
                        #set($getprefix="get")
                #end
                .or().like(${entity}::${getprefix}${field.capitalName}, keyword)
        #end
        ).orderByDesc(${entity}::getId);
        return this.page(page, wrapper);
    }
}
#end

